---
layout : post
title : SSH协议简单应用(二):隧道与端口转发
category : TCP/IP协议
tags : SSH协议 隧道 端口转发
---

#**{{page.title}}**
---
> 自从更换到Ubuntu的操作环境，越来越被Linux的魅力所吸引，其众多的快捷键，更好的稳定性以及更快的速度等极大地提高了开发效率，而作为Linux基本配置的SSH更是让我大开眼界，通过Linux的SSH工具，可以让我们完成许多不可思议的工作，下面我将总结一下使用SSH以来的一些小知识，内容浅显，不足以体现SSH的博大精深。

### **一、简单介绍**
#### *1.1 背景*
在最早的时候，互联网的通信都是以明文进行传输，这种传输方式安全性极差，一旦传输内容被截获，内容就将暴露无遗。1xxx年，xxxx设计了SSH协议，将登陆信息进行了加密，很快地这种协议成为了互联网安全的一种解决方案，并得到了广泛的普及。
#### *1.2 定义*
*SSH(Secure Shell)* 是一种网络协议，该协议可以将传输的数据进行加密，以保证数据在网络传输过程中的安全性。      
#### *1.3 SSH工具*
需要注意的是，SSH是一种协议，其存在了多种实现，在Ubuntu中默认配置的SSH工具为OpenSSH，而Windows下则PuTTY使用得更多。本文章以Linux下的OPenSSH为例展开总结。

### **二、基本使用**
#### *2.1 远程登陆*
SSH最常用于远程登陆，如下，表示连接到用户名为boxiZen，远程ip地址为172.26.12.159的机器上 :

    ssh boxizen@172.26.12.159　//默认端口为22
    ssh 172.26.12.159   //若本地用户名与远程机器用户相同，则可以省略用户名          

#### *2.2 修改端口*
    ssh -p 12530 boxizen@172.26.12.159

#### *2.3 口令登陆*
当不做任何配置，输入上述命令时，会要求你输入密码，若密码正确则可以正常登陆了．
当远程的公钥被接收后，它会保存在文件$HOME/.ssh/known_hosts中

#### *2.４ 登陆过程*
1. 用户使用ssh命令请求连接远程服务器
2. 服务器接收到来自用户的登陆请求，把自己的公钥发给用户
3. 用户使用服务器的公钥将登陆密码加密后，再发给用户
4. 服务器使用自己的私钥解析密码，若密码正确，则同意用户登陆．

### **三、公钥登陆**
使用口令登陆的缺点是，每次登陆到远程服务器都要输入密码，非常麻烦，而且容易受到"中间人"的攻击．所谓的中间人攻击是指，可能会有别的机器冒充真正的服务器，利用他们提供的公钥套取用户的信息．

所幸的是ssh还提供了**公钥登陆**的方式进行安全登陆

    ssh-keygen //在客户端生成公钥       

执行了上述命令后，会在$HOME/.ssh目录下生成id_rsa.pub和id_rsa两个文件，其中前者为公钥，后者为私钥

    ssh-copy-id boxizen@172.26.12.159

上述命令将公钥上传到远程主机上面，执行成功了，再也不需要输入密码即可实现登陆了．
用户的公钥会保存在服务器目录下的$HOME/.ssh/authorized_keys文件中
